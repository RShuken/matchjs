<div class="container"  ng-controller="InboxController as ctrl" ng-init="ctrl.getAllUsers()">
  <div class="row mainContainer">

      <div class="col-md-4 conversations">
        <div class="panel panel-primary">
          <div class="panel-heading">
          <!-- SEARCH USERS -->
            <div>
              <ui-select ng-model="user.selected" theme="bootstrap" ng-disabled="disabled" style="min-width: 100px;">
                <ui-select-match placeholder="Start a new conversation">Start a new conversation</ui-select-match>
                <ui-select-choices repeat="user in ctrl.users | filter: {name: $select.search}" ng-click="ctrl.switchConversation(user)">
                  <div ng-bind-html="user.name | highlight: $select.search"></div>
                  <small>
                  <span ng-bind-html="''| highlight: $select.search"></span>
                  </small>
                </ui-select-choices>
              </ui-select>
            </div>
          </div>

          <div class="panel-body" class="conversationBox" >
            <ul class="media-list">
              <li class="left clearfix" class="media" ng-repeat="conversation in ctrl.conversationList track by $index" class = "conversation" ng-click="ctrl.switchConversation(conversation)" ng-if="conversation.username != ctrl.username">
                <div class="media-body">
                  <div class="media">
                    <div class="pull-left">
                      <img class="media-object img-circle" ng-src="{{conversation.photo || 'http://placehold.it/80x80'}}" style=" width: 80px; height: 80px">
                    </div>
                    <div class="media-body" >
                      <h5>{{conversation.name}}</h5>
                       <small class="text-muted">5 min ago</small>
                    </div>
                  </div>
                </div>
                 <hr/>
              </li>
            </ul>
          </div>

        </div>
      </div>
    
    <div class="col-md-8">
        <div class="panel panel-primary">
            <div class="panel-heading">
              <span class="glyphicon glyphicon-comment"></span>
              Conversation with {{ctrl.currentRecipientName}}
            </div>

            <div class="panel-body" scroll-glue  class="chat" id="panel-chat">
              <div ng-show="ctrl.currentRecipient" class="messageBox">
                <ul class="media-list" class="messageList" id="msgList">
                  <!-- one message in inbox -->
                  <li class="media" ng-model="ctrl.currentMessageList" ng-repeat="message in ctrl.currentMessageList track by $index" class="message">
                    <span class="chat-img pull-left">
                      <img class="media-object img-circle" ng-src="{{ctrl.currentRecipientPhoto || 'http://placehold.it/80x80'}}" style=" width: 40px; height: 40px">
                    </span>
                    <div class="chat-body clearfix">
                      <div class="header">
                        <strong class="primary-font"> {{message.from}}</strong> 
                        <small class="pull-right text-muted">
                        <span class="glyphicon glyphicon-time">
                        </span> 
                        {{message.time}}
                        </small>
                      </div>
                        <p> {{message.message}} </p>
                    </div>
                    <hr/>
                  </li>
                </ul>
              </div>
          </div>

            <div class="panel-footer">
                  <div class="messageInput">
                    <div class="input-group" >
                      <input type="text" class="form-control" placeholder="Enter your message" ng-model="ctrl.enteredText" ng-submit="ctrl.sendMessage()">
                      <span class="input-group-btn">
                      <button type="submit" class="btn btn-primary" ng-click="ctrl.sendMessage()">Submit</button>
                      </span>
                    </div>

                  </div>
            </div>
        </div>
    </div>
  </div>
</div>

<footer-dir></footer-dir>